{"ast":null,"code":"import{loadTossPayments}from\"@tosspayments/tosspayments-sdk\";import{useEffect,useState}from\"react\";import{useNavigate,useLocation}from\"react-router-dom\";import'./toss.css';import axios from\"axios\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const clientKey=\"test_ck_26DlbXAaV01XDv0Gew4xrqY50Q9R\";// wg\n//const clientKey = \"test_ck_5OWRapdA8dqJN5YkmkBB3o1zEqZK\"; //jj\nconst generateRandomString=()=>window.btoa(Math.random().toString()).slice(0,20);const customerKey=generateRandomString();export function ItemPaymentCheckoutPage(){const[payment,setPayment]=useState(null);const[selectedPaymentMethod,setSelectedPaymentMethod]=useState(null);const navigate=useNavigate();const location=useLocation();//const { productName, finalPrice } = location.state; \nconst{itemPayInfo}=location.state||{};const[orderName,setOrderName]=useState(\"\");//console.log(\"!!!!!!!!!!!!!itemPayInfo\", itemPayInfo);\nsessionStorage.setItem('itemPaymentInfo',JSON.stringify(itemPayInfo));/*\r\n  const test = () => {\r\n    axios.post(\"/test\", itemPayInfo)\r\n    .then((response) => {\r\n      console.log(\"등록\");\r\n    })\r\n    .catch((error) => {\r\n      console.log(\"실패\");\r\n    })\r\n  }\r\n  */const selectPaymentMethod=method=>{setSelectedPaymentMethod(method);};useEffect(()=>{//console.log(\"0000000000\")\nif(itemPayInfo.items.length>1){//console.log(\"11111111111\")\nsetOrderName(itemPayInfo.items[0].itemName+\" 외 \"+(itemPayInfo.items.length-1)+\" 건\");}else{//console.log(\"2222222222\")\nsetOrderName(itemPayInfo.items[0].itemName);}},[itemPayInfo]);useEffect(()=>{async function fetchPayment(){try{const tossPayments=await loadTossPayments(clientKey);const payment=tossPayments.payment({customerKey});setPayment(payment);}catch(error){console.error(\"결제 정보를 불러오는 중 오류가 발생했습니다:\",error);}}fetchPayment();},[]);const requestPayment=async()=>{//console.log(\"window.location.origin : \" + window.location.origin);\n//window.location.origin = http://localhost:3000\ntry{const orderId=generateRandomString();//test();\nconst response=await payment.requestPayment({method:selectedPaymentMethod,amount:{currency:\"KRW\",value:itemPayInfo.amount},orderId,orderName:orderName,successUrl:window.location.origin+\"/store/payment/success\",failUrl:window.location.origin+\"/store/payment/fail\",customerEmail:itemPayInfo.itempay_email,customerName:itemPayInfo.itempay_buyer,customerMobilePhone:itemPayInfo.customerMobilePhone});//test();\n//console.log(response);\nnavigate('/payment/success',{state:{paymentInfo:itemPayInfo,response}});}catch(error){console.error(\"결제 요청 중 오류가 발생했습니다:\",error);}};return/*#__PURE__*/_jsx(\"div\",{className:\"wrapper\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"box_section\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\uC77C\\uBC18 \\uACB0\\uC81C\"}),/*#__PURE__*/_jsx(\"div\",{id:\"payment-method\",children:[\"CARD\",\"TRANSFER\",\"VIRTUAL_ACCOUNT\",\"MOBILE_PHONE\",\"CULTURE_GIFT_CERTIFICATE\",\"FOREIGN_EASY_PAY\"].map(method=>/*#__PURE__*/_jsx(\"button\",{id:method,className:`button2 ${selectedPaymentMethod===method?\"active\":\"\"}`,onClick:()=>selectPaymentMethod(method),children:method},method))}),/*#__PURE__*/_jsx(\"button\",{className:\"button\",onClick:requestPayment,children:\"\\uACB0\\uC81C\\uD558\\uAE30\"})]})});}export default ItemPaymentCheckoutPage;","map":{"version":3,"names":["loadTossPayments","useEffect","useState","useNavigate","useLocation","axios","jsx","_jsx","jsxs","_jsxs","clientKey","generateRandomString","window","btoa","Math","random","toString","slice","customerKey","ItemPaymentCheckoutPage","payment","setPayment","selectedPaymentMethod","setSelectedPaymentMethod","navigate","location","itemPayInfo","state","orderName","setOrderName","sessionStorage","setItem","JSON","stringify","selectPaymentMethod","method","items","length","itemName","fetchPayment","tossPayments","error","console","requestPayment","orderId","response","amount","currency","value","successUrl","origin","failUrl","customerEmail","itempay_email","customerName","itempay_buyer","customerMobilePhone","paymentInfo","className","children","id","map","onClick"],"sources":["C:/Users/user1/Desktop/sixsence/Sixsence/src/main/sixsence-front/src/store/payment/ItemPaymentCheckoutPage.js"],"sourcesContent":["import { loadTossPayments } from \"@tosspayments/tosspayments-sdk\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useNavigate, useLocation } from \"react-router-dom\";\r\nimport './toss.css';\r\nimport axios from \"axios\";\r\n\r\nconst clientKey = \"test_ck_26DlbXAaV01XDv0Gew4xrqY50Q9R\"; // wg\r\n//const clientKey = \"test_ck_5OWRapdA8dqJN5YkmkBB3o1zEqZK\"; //jj\r\nconst generateRandomString = () => window.btoa(Math.random().toString()).slice(0, 20);\r\nconst customerKey = generateRandomString();\r\n\r\nexport function ItemPaymentCheckoutPage() {\r\n  const [payment, setPayment] = useState(null);\r\n  const [selectedPaymentMethod, setSelectedPaymentMethod] = useState(null);\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  //const { productName, finalPrice } = location.state; \r\n  const { itemPayInfo } = location.state || {};\r\n  const [orderName, setOrderName] = useState(\"\");\r\n  //console.log(\"!!!!!!!!!!!!!itemPayInfo\", itemPayInfo);\r\n  sessionStorage.setItem('itemPaymentInfo', JSON.stringify(itemPayInfo));\r\n\r\n  /*\r\n  const test = () => {\r\n    axios.post(\"/test\", itemPayInfo)\r\n    .then((response) => {\r\n      console.log(\"등록\");\r\n    })\r\n    .catch((error) => {\r\n      console.log(\"실패\");\r\n    })\r\n  }\r\n  */\r\n  const selectPaymentMethod = (method) => {\r\n    setSelectedPaymentMethod(method);\r\n  };\r\n\r\n  useEffect(()=> {\r\n    //console.log(\"0000000000\")\r\n    if (itemPayInfo.items.length >1) {\r\n      //console.log(\"11111111111\")\r\n      setOrderName(itemPayInfo.items[0].itemName + \" 외 \" + (itemPayInfo.items.length - 1) + \" 건\")\r\n    } else {\r\n      //console.log(\"2222222222\")\r\n      setOrderName(itemPayInfo.items[0].itemName)\r\n    }\r\n  }, [itemPayInfo])\r\n\r\n  useEffect(() => {\r\n    async function fetchPayment() {\r\n      try {\r\n        const tossPayments = await loadTossPayments(clientKey);\r\n        const payment = tossPayments.payment({\r\n          customerKey,\r\n        });\r\n        setPayment(payment);\r\n      } catch (error) {\r\n        console.error(\"결제 정보를 불러오는 중 오류가 발생했습니다:\", error);\r\n      }\r\n    }\r\n\r\n    fetchPayment();\r\n  }, []);\r\n\r\n  const requestPayment = async () => {\r\n    //console.log(\"window.location.origin : \" + window.location.origin);\r\n    //window.location.origin = http://localhost:3000\r\n    try {\r\n      const orderId = generateRandomString();\r\n      //test();\r\n      const response = await payment.requestPayment({\r\n        method: selectedPaymentMethod,\r\n        amount: {\r\n          currency: \"KRW\",\r\n          value: itemPayInfo.amount,\r\n        },\r\n        orderId,\r\n        orderName: orderName,\r\n        successUrl: window.location.origin + \"/store/payment/success\",\r\n        failUrl: window.location.origin + \"/store/payment/fail\",\r\n        customerEmail: itemPayInfo.itempay_email,\r\n        customerName: itemPayInfo.itempay_buyer,\r\n        customerMobilePhone: itemPayInfo.customerMobilePhone,\r\n      });\r\n      //test();\r\n      //console.log(response);\r\n      navigate('/payment/success', { state: { paymentInfo: itemPayInfo, response } });\r\n      \r\n    } catch (error) {\r\n      console.error(\"결제 요청 중 오류가 발생했습니다:\", error);\r\n      \r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"wrapper\">\r\n      <div className=\"box_section\">\r\n        <h1>일반 결제</h1>\r\n        <div id=\"payment-method\">\r\n          {[\"CARD\", \"TRANSFER\", \"VIRTUAL_ACCOUNT\", \"MOBILE_PHONE\", \"CULTURE_GIFT_CERTIFICATE\", \"FOREIGN_EASY_PAY\"].map((method) => (\r\n            <button\r\n              key={method}\r\n              id={method}\r\n              className={`button2 ${selectedPaymentMethod === method ? \"active\" : \"\"}`}\r\n              onClick={() => selectPaymentMethod(method)}\r\n            >\r\n              {method}\r\n            </button>\r\n          ))}\r\n        </div>\r\n        <button className=\"button\" onClick={requestPayment}>\r\n          결제하기\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ItemPaymentCheckoutPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}