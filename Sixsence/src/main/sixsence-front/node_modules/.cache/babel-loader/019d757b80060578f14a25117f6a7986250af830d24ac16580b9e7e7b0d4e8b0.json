{"ast":null,"code":"import React,{useState,useEffect,useContext}from\"react\";import{useLocation,useNavigate}from\"react-router-dom\";import Calendar from\"react-calendar\";import axios from\"axios\";import LoginContext from\"../../login/LoginContext\";import\"./Booking.css\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Booking=()=>{const{loginMember,setLoginMember}=useContext(LoginContext);const location=useLocation();const queryParams=new URLSearchParams(location.search);const movieId=queryParams.get(\"movieId\");const[movies,setMovies]=useState([]);const[selectedMovie,setSelectedMovie]=useState(null);const[selectedSeat,setSelectedSeat]=useState([]);const[tempSelectedSeats,setTempSelectedSeats]=useState([]);const[selectedandSeat,setSelectedandSeat]=useState([]);const[numPeople,setNumPeople]=useState(1);const[selectedRegion,setSelectedRegion]=useState(null);const[selectedDate,setSelectedDate]=useState(new Date());const[selectedTime,setSelectedTime]=useState(null);const[adultTickets,setAdultTickets]=useState(null);const[childTickets,setChildTickets]=useState(null);const[totalPoints,setTotalPoints]=useState(0);const[usePoints,setUsePoints]=useState(0);const[usingPoints,setUsingPoints]=useState(false);const[userPoints,setUserPoints]=useState(\"0\");const navigate=useNavigate();const Pointsheld=loginMember?loginMember.memberPoint:0;const[movieNo,setMovieNo]=useState(null);const[isModalOpen,setIsModalOpen]=useState(false);const[loginin,setLoginIn]=useState(false);// 로그인 상태를 확인하여 loginin 설정\nuseEffect(()=>{const savedMember=sessionStorage.getItem(\"loginMember\");if(savedMember){setLoginMember(JSON.parse(savedMember));setLoginIn(true);}else{setLoginIn(false);}},[setLoginMember]);const openModal=()=>{setTempSelectedSeats([...selectedSeat]);setIsModalOpen(true);};const closeModal=()=>{setIsModalOpen(false);};//movieTitle을 selectedMovie에서 가져오기\nconst movieTitle=selectedMovie?selectedMovie.movieTitle:\"영화 제목 없음\";// 현재 시간 불러옴\nconst MTDate=new Date();const MTHours=MTDate.getHours();const MTMinutes=MTDate.getMinutes();const isTimePassed=(hour,minute)=>{if(!selectedDate)return false;if(selectedDate.getFullYear()===MTDate.getFullYear()&&selectedDate.getMonth()===MTDate.getMonth()&&selectedDate.getDate()===MTDate.getDate()){return hour<MTHours||hour===MTHours&&minute<MTMinutes;}return false;};const handleTimeChange=time=>{if(selectedDate){const[hour,minute,second]=time.split(\":\").map(Number);if(isTimePassed(hour,minute)){alert(\"이미 지난 시간은 선택할 수 없습니다.\");return;}}setSelectedTime(prevTime=>prevTime===time?null:time);};const handleSeatClick=seat=>{if(tempSelectedSeats.includes(seat)){setTempSelectedSeats(tempSelectedSeats.filter(s=>s!==seat));}else if(tempSelectedSeats.length<adultTickets+childTickets){setTempSelectedSeats([...tempSelectedSeats,seat]);}};const confirmSeatSelection=()=>{setSelectedSeat(tempSelectedSeats);closeModal();};const resetbutton=()=>{//리셋버튼\nsetSelectedMovie(null);setSelectedRegion(null);setSelectedSeat([]);setSelectedTime(null);setSelectedDate(new Date());setNumPeople(1);setAdultTickets(0);setChildTickets(0);setUsePoints(0);};const handleMovieClick=movie=>{setSelectedMovie(movie);setMovieNo(movie.movieNo);setSelectedTime(null);// 영화 변경 시 시간 초기화\n};const getPosterPath=movie=>{return`${process.env.PUBLIC_URL}${movie.movieImage.replace(\"./\",\"/\")}`;};const PointUseTotalPrice=()=>{const totalPrice=adultTickets*100+childTickets*100;const finalPrice=usingPoints?totalPrice-usePoints:totalPrice;return finalPrice>0?finalPrice:0;};const UsePoints=()=>{setUsingPoints(!usingPoints);if(!usingPoints){setUsePoints(0);}};const UsePointChange=e=>{const value=parseInt(e.target.value);const totalPrice=adultTickets*100+childTickets*100;if(!isNaN(value)){if(value>totalPrice){// 총 결제 금액을 초과할 수 없도록 설정\nsetUsePoints(totalPrice);}else if(value>=0&&value<=Pointsheld){setUsePoints(value);// 입력된 포인트가 총 결제 금액 이하일 경우 설정\n}}};const Accumulate=()=>{// 마일리지 포인트 적립\nif(usingPoints){return 0;// 포인트를 사용할 경우 적립금은 0\n}return Math.floor((adultTickets*100+childTickets*100)*0.1);};const handleRegionChange=region=>{setSelectedRegion(prevRegion=>prevRegion===region?null:region);};const today=new Date();const maxDate=new Date(today);maxDate.setDate(today.getDate()+6);const handleDateChange=date=>{if(date>=today&&date<=maxDate){setSelectedDate(date);setSelectedTime(null);// 날짜 변경 시 선택한 시간 초기화\n}else{console.error(\"잘못된 날짜 선택\");}};const calendar=_ref=>{let{date,view}=_ref;const maxDate=new Date(today);maxDate.setDate(today.getDate()+6);const lastDayOfMonth=new Date(today.getFullYear(),today.getMonth()+1,0);return view===\"month\"&&(date<today.setHours(0,0,0,0)||date>maxDate||date>lastDayOfMonth);};const handleAdultTickets=e=>{const value=parseInt(e.target.value);if(!isNaN(value)&&value>=0&&value<=4&&value+childTickets<=4){setAdultTickets(value);setSelectedSeat([]);}};const handleChildTickets=e=>{const value=parseInt(e.target.value);if(!isNaN(value)&&value>=0&&value<=4&&value+adultTickets<=4){setChildTickets(value);setSelectedSeat([]);}};useEffect(()=>{const fetchMovies=async()=>{try{const response=await axios.get(\"/moviepay/movies\");setMovies(response.data);if(movieId){const movie=response.data.find(m=>m.movieNo===parseInt(movieId));setSelectedMovie(movie);}}catch(err){console.error(\"Error loading movie data: \",err);}};fetchMovies();},[movieId]);useEffect(()=>{const fetchAndSetSeats=async()=>{if(movieNo&&selectedTime&&selectedDate){const formattedDate=selectedDate.toLocaleDateString(\"ko-KR\",{year:\"numeric\",month:\"2-digit\",day:\"2-digit\"}).replace(/. /g,\"-\").replace(\".\",\"\");try{const fetchURL=`/moviepay/movieSeat/${movieNo}?viewDate=${formattedDate}&time=${selectedTime}`;const response=await fetch(fetchURL);if(!response.ok){throw new Error(`HTTP error! status: ${response.status}`);}const data=await response.json();//좌석 데이터를 배열로 변환 (이 코드로 좌석 예매된거 표시 해결)\nconst parseData=data[0]?data[0].split(\",\").map(seat=>seat.trim()):[];setSelectedandSeat(parseData);// 이미 예약된 좌석을 비활성 상태로 설정\n}catch(error){console.error(\"좌석 에러 :\",error);}}else{console.error(\"값이 누락되었습니다\");}};fetchAndSetSeats();},[movieNo,selectedTime,selectedDate]);//좌석 선택이 변경될 때마다 다시 불러옴\nconst handleConfirmPayment=()=>{// 로그인 상태를 loginin 대신 loginMember로 확인\nif(!loginMember||!loginMember.memberNo){alert(\"로그인이 필요합니다. 로그인 페이지로 이동합니다.\");navigate(\"/MemberLogin\");return;}if(!selectedMovie||!selectedRegion||!selectedDate||!selectedTime||adultTickets===0&&childTickets===0||selectedSeat.length===0){alert(\"모든 항목을 선택해야 결제 페이지로 넘어갑니다.\");return;}const selectedDateString=new Date(selectedDate.getTime()-selectedDate.getTimezoneOffset()*60000).toISOString().split(\"T\")[0];// 총 결제 금액 계산\nconst finalPrice=adultTickets*100+childTickets*100-usePoints;const accumulatedPoints=usingPoints?0:Math.floor((adultTickets*100+childTickets*100)*0.1);// Math.floor 소수점 버림처리\n// 현재 포인트에 적립 포인트 더하기\nconst newTotalPoints=Number(loginMember.memberPoint)-usePoints+Number(accumulatedPoints);// 포인트 업데이트 반영한 회원 정보\nconst updatedLoginmember={...loginMember,memberPoint:newTotalPoints};// 상태 업데이트\nsetLoginMember(updatedLoginmember);setUserPoints(newTotalPoints);// 로컬 스토리지에도 업데이트된 포인트 반영.\nlocalStorage.setItem(\"loginMember\",JSON.stringify(updatedLoginmember));alert(`결제 페이지로 넘어갑니다.`);resetbutton();navigate(\"/payment/checkout\",{state:{productName:`${selectedMovie.movieTitle} / ${movieNo} / ${selectedRegion} / ${selectedDate} / ${selectedTime} / ${selectedSeat.join(\", \")}`,movieTitle,finalPrice,adultTickets,childTickets,selectedSeat:selectedSeat.join(\", \"),// 좌석을 문자열로 전달\nselectedDate:selectedDateString,// 대한민국 시간대에 맞춘 YYYY-MM-DD 형식의 날짜 전달\nselectedTime,selectedRegion,usePoints,accumulatedPoints,// 새로 적립된 포인트 전달\nmemberNo:loginMember.memberNo,movieNo:movieNo,memberGrade:loginMember.memberGrade,memberPayCount:loginMember.memberPayCount,Pointsheld:newTotalPoints// 업데이트된 포인트 전달\n}});};return/*#__PURE__*/_jsxs(\"div\",{className:\"booking\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"movie-list\",children:movies.map(movie=>/*#__PURE__*/_jsxs(\"div\",{className:\"movie-item\",onClick:()=>handleMovieClick(movie),children:[/*#__PURE__*/_jsx(\"img\",{src:getPosterPath(movie),alt:movie.movieTitle}),/*#__PURE__*/_jsx(\"p\",{children:movie.title})]},movie.id))}),/*#__PURE__*/_jsxs(\"div\",{className:\"content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"resetbutton\",children:/*#__PURE__*/_jsx(\"button\",{onClick:resetbutton,children:\"\\uC608\\uB9E4 \\uB2E4\\uC2DC\\uD558\\uAE30\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"MTheader\",children:selectedMovie?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"movie-info\",children:[/*#__PURE__*/_jsx(\"img\",{src:getPosterPath(selectedMovie),alt:\"Movie Poster\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"movie-details\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uC601\\uD654 : \",selectedMovie.movieTitle]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uC601\\uD654\\uAD00 : \",selectedRegion]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uAD00\\uB78C\\uC77C\\uC2DC :\",\" \",selectedDate?selectedDate.toLocaleDateString(\"ko-KR\",{year:\"numeric\",month:\"long\",day:\"numeric\",weekday:\"long\"}):\"날짜를 선택하세요\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uC0C1\\uC601\\uC2DC\\uAC04 : \",selectedTime]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uC120\\uD0DD\\uC88C\\uC11D :\",\" \",selectedSeat.length>0?selectedSeat.join(\", \"):\"없음\"]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"total-price\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"infobutton\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uCD1D \\uACB0\\uC81C\\uAE08\\uC561: \",PointUseTotalPrice(),\" \\uC6D0\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uD3EC\\uC778\\uD2B8 \\uC0AC\\uC6A9 \\uC5EC\\uBD80 :\",/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:usingPoints,onChange:UsePoints}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uBCF4\\uC720 \\uD3EC\\uC778\\uD2B8 : \",Pointsheld,\" \\uC810 \"]})]}),usingPoints&&/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uC0AC\\uC6A9\\uD560 \\uD3EC\\uC778\\uD2B8 :\",/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:usePoints,onChange:UsePointChange})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uC801\\uB9BD\\uB420 \\uD3EC\\uC778\\uD2B8 : \",Accumulate(),\"\\uC810\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"confirm-button\",onClick:handleConfirmPayment,children:\"\\uACB0\\uC81C\"})]})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsxs(\"strong\",{children:[\"\\u203B \\uD3EC\\uC778\\uD2B8\\uB97C \\uC0AC\\uC6A9\\uD574 \\uC608\\uB9E4 \\uD560 \\uACBD\\uC6B0\",/*#__PURE__*/_jsx(\"br\",{}),\"\\uD3EC\\uC778\\uD2B8\\uB294 \\uB530\\uB85C \\uC801\\uB9BD\\uB418\\uC9C0 \\uC54A\\uC2B5\\uB2C8\\uB2E4.\"]})}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"strong\",{children:\"\\u203B \\uAD00\\uB78C\\uC77C \\uC120\\uD0DD\\uC740 \\uC624\\uB298 \\uB0A0\\uC9DC \\uD3EC\\uD568 7\\uC77C \\uC785\\uB2C8\\uB2E4.\"})})]})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"default-movie-info\",children:[/*#__PURE__*/_jsx(\"img\",{src:process.env.PUBLIC_URL+\"/movieimages/select_movie1.jpg\",alt:\"Default\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\uC120\\uD0DD\\uD55C \\uC601\\uD654\\uAC00 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"steps-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"step\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"STEP1: \\uC601\\uD654\\uAD00 \\uC120\\uD0DD\"}),/*#__PURE__*/_jsx(\"button\",{className:`step-button ${selectedRegion===\"강남\"?\"selected\":\"fail\"}`,onClick:()=>handleRegionChange(\"강남\"),children:\"\\uAC15\\uB0A8\"}),/*#__PURE__*/_jsx(\"button\",{className:`step-button ${selectedRegion===\"역삼\"?\"selected\":\"fail\"}`,onClick:()=>handleRegionChange(\"역삼\"),children:\"\\uC5ED\\uC0BC\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"step\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"STEP2: \\uAD00\\uB78C\\uC77C \\uC120\\uD0DD\"}),/*#__PURE__*/_jsx(Calendar,{className:\"mtcalendar\",onChange:handleDateChange,value:selectedDate||new Date(),locale:\"ko-KR\",minDate:today,maxDate:maxDate,tileDisabled:calendar,showNeighboringMonth:false})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"step\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"STEP3: \\uAD00\\uB78C\\uC2DC\\uAC04 \\uC120\\uD0DD\"}),/*#__PURE__*/_jsx(\"button\",{className:`step-button ${selectedTime==='10:40:00'?'selected':'fail'}`,onClick:()=>handleTimeChange(\"10:40:00\"),children:\"10:40\"}),/*#__PURE__*/_jsx(\"button\",{className:`step-button ${selectedTime==='13:45:00'?'selected':'fail'}`,onClick:()=>handleTimeChange(\"13:45:00\"),children:\"13:45\"}),/*#__PURE__*/_jsx(\"button\",{className:`step-button ${selectedTime==='17:00:00'?'selected':'fail'}`,onClick:()=>handleTimeChange(\"17:00:00\"),children:\"17:00\"}),/*#__PURE__*/_jsx(\"button\",{className:`step-button ${selectedTime==='19:40:00'?'selected':'fail'}`,onClick:()=>handleTimeChange(\"19:40:00\"),children:\"19:40\"}),/*#__PURE__*/_jsx(\"button\",{className:`step-button ${selectedTime==='22:20:00'?'selected':'fail'}`,onClick:()=>handleTimeChange(\"22:20:00\"),children:\"22:20\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"step\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"STEP4: \\uC88C\\uC11D \\uBC0F \\uC794\\uC5EC\\uC11D \\uD655\\uC778\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"seat-selection\",children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"\\uC77C\\uBC18 (100\\uC6D0)\",/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"0\",max:\"4\",value:adultTickets,onChange:handleAdultTickets}),/*#__PURE__*/_jsx(\"br\",{})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"\\uCCAD\\uC18C\\uB144 (100\\uC6D0)\",/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"0\",max:\"4\",value:childTickets,onChange:handleChildTickets})]}),/*#__PURE__*/_jsx(\"button\",{className:\"step-button\",onClick:openModal,children:\"\\uC88C\\uC11D \\uC120\\uD0DD\\uD558\\uAE30\"})]})]})]}),isModalOpen&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"close-button\",onClick:closeModal,children:\"\\xD7\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"screen\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"moviescreen\",children:\"SCREEN\"}),/*#__PURE__*/_jsx(\"div\",{className:\"seats\",children:[\"A\",\"B\",\"C\",\"D\",\"E\",\"F\",\"G\",\"H\"].map(row=>/*#__PURE__*/_jsxs(\"div\",{className:\"seat-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"row-label\",children:row}),[1,2,3,4,5,6,7,8,9].map(col=>{const seat=`${row}${col}`;return/*#__PURE__*/_jsx(\"button\",{className:`seat ${tempSelectedSeats.includes(seat)?\"selected\":\"\"} ${selectedandSeat.includes(seat)?\"booked\":\"\"}`,onClick:()=>handleSeatClick(seat),disabled:selectedandSeat.includes(seat)// 예매된 좌석은 비활성화\n,children:seat},seat);})]},row))})]}),/*#__PURE__*/_jsx(\"button\",{className:\"confirm-button\",onClick:confirmSeatSelection,children:\"\\uC120\\uD0DD \\uC644\\uB8CC\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"notice\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"\\uC608\\uB9E4 \\uC2DC \\uC8FC\\uC758\\uC0AC\\uD56D\"}),/*#__PURE__*/_jsxs(\"dl\",{children:[/*#__PURE__*/_jsx(\"dt\",{children:\"1. \\uD648\\uD398\\uC774\\uC9C0 \\uC608\\uB9E4 \\uD6C4 \\uC601\\uD654\\uBCC4 \\uC2E4\\uC218\\uAD00\\uBC88\\uD638 \\uBC1C\\uD589\\uB420 \\uC218 \\uC788\\uC2B5\\uB2C8\\uB2E4.\"}),/*#__PURE__*/_jsx(\"dt\",{children:\"2. \\uC601\\uD654 \\uC608\\uB9E4\\uB294 \\uAD00\\uB78C\\uC77C \\uC804\\uB0A0 \\uCDE8\\uC18C \\uC2DC \\uC218\\uC218\\uB8CC \\uC5C6\\uC774 \\uCDE8\\uC18C \\uAC00\\uB2A5\\uD569\\uB2C8\\uB2E4.\"}),/*#__PURE__*/_jsx(\"dt\",{children:\"3. \\uC0C1\\uC601\\uAD00 \\uC785\\uC7A5\\uC740 \\uC0C1\\uC601\\uC2DC\\uAC04 10\\uBD84 \\uC804\\uBD80\\uD130 \\uAC00\\uB2A5\\uD569\\uB2C8\\uB2E4.\"}),/*#__PURE__*/_jsx(\"dt\",{children:\"4. \\uD560\\uC778\\uD61C\\uD0DD\\uC740 \\uC911\\uBCF5\\uC801\\uC6A9\\uC774 \\uBD88\\uAC00\\uD569\\uB2C8\\uB2E4.\"}),/*#__PURE__*/_jsx(\"dt\",{children:\"5. \\uC88C\\uC11D\\uC740 \\uD55C \\uACC4\\uC815\\uB2F9 \\uCD1D 4\\uC790\\uB9AC\\uB9CC \\uC608\\uB9E4 \\uAC00\\uB2A5\\uD569\\uB2C8\\uB2E4.\"})]})]})]})]});};export default Booking;","map":{"version":3,"names":["React","useState","useEffect","useContext","useLocation","useNavigate","Calendar","axios","LoginContext","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Booking","loginMember","setLoginMember","location","queryParams","URLSearchParams","search","movieId","get","movies","setMovies","selectedMovie","setSelectedMovie","selectedSeat","setSelectedSeat","tempSelectedSeats","setTempSelectedSeats","selectedandSeat","setSelectedandSeat","numPeople","setNumPeople","selectedRegion","setSelectedRegion","selectedDate","setSelectedDate","Date","selectedTime","setSelectedTime","adultTickets","setAdultTickets","childTickets","setChildTickets","totalPoints","setTotalPoints","usePoints","setUsePoints","usingPoints","setUsingPoints","userPoints","setUserPoints","navigate","Pointsheld","memberPoint","movieNo","setMovieNo","isModalOpen","setIsModalOpen","loginin","setLoginIn","savedMember","sessionStorage","getItem","JSON","parse","openModal","closeModal","movieTitle","MTDate","MTHours","getHours","MTMinutes","getMinutes","isTimePassed","hour","minute","getFullYear","getMonth","getDate","handleTimeChange","time","second","split","map","Number","alert","prevTime","handleSeatClick","seat","includes","filter","s","length","confirmSeatSelection","resetbutton","handleMovieClick","movie","getPosterPath","process","env","PUBLIC_URL","movieImage","replace","PointUseTotalPrice","totalPrice","finalPrice","UsePoints","UsePointChange","e","value","parseInt","target","isNaN","Accumulate","Math","floor","handleRegionChange","region","prevRegion","today","maxDate","setDate","handleDateChange","date","console","error","calendar","_ref","view","lastDayOfMonth","setHours","handleAdultTickets","handleChildTickets","fetchMovies","response","data","find","m","err","fetchAndSetSeats","formattedDate","toLocaleDateString","year","month","day","fetchURL","fetch","ok","Error","status","json","parseData","trim","handleConfirmPayment","memberNo","selectedDateString","getTime","getTimezoneOffset","toISOString","accumulatedPoints","newTotalPoints","updatedLoginmember","localStorage","setItem","stringify","state","productName","join","memberGrade","memberPayCount","className","children","onClick","src","alt","title","id","weekday","type","checked","onChange","locale","minDate","tileDisabled","showNeighboringMonth","min","max","row","col","disabled"],"sources":["C:/Users/user1/Desktop/sixsence/Sixsence/src/main/sixsence-front/src/moviechart/Movieboard-app/Booking.js"],"sourcesContent":["import React, { useState, useEffect, useContext } from \"react\";\r\nimport { useLocation, useNavigate } from \"react-router-dom\";\r\nimport Calendar from \"react-calendar\";\r\nimport axios from \"axios\";\r\nimport LoginContext from \"../../login/LoginContext\";\r\nimport \"./Booking.css\";\r\n\r\nconst Booking = () => {\r\n  const { loginMember, setLoginMember } = useContext(LoginContext);\r\n  const location = useLocation();\r\n  const queryParams = new URLSearchParams(location.search);\r\n  const movieId = queryParams.get(\"movieId\");\r\n  const [movies, setMovies] = useState([]);\r\n  const [selectedMovie, setSelectedMovie] = useState(null);\r\n  const [selectedSeat, setSelectedSeat] = useState([]);\r\n  const [tempSelectedSeats, setTempSelectedSeats] = useState([]);\r\n  const [selectedandSeat, setSelectedandSeat] = useState([]);\r\n  const [numPeople, setNumPeople] = useState(1);\r\n  const [selectedRegion, setSelectedRegion] = useState(null);\r\n  const [selectedDate, setSelectedDate] = useState(new Date());\r\n  const [selectedTime, setSelectedTime] = useState(null);\r\n  const [adultTickets, setAdultTickets] = useState(null);\r\n  const [childTickets, setChildTickets] = useState(null);\r\n  const [totalPoints, setTotalPoints] = useState(0);\r\n  const [usePoints, setUsePoints] = useState(0);\r\n  const [usingPoints, setUsingPoints] = useState(false);\r\n  const [userPoints, setUserPoints] = useState(\"0\");\r\n  const navigate = useNavigate();\r\n  const Pointsheld = loginMember ? loginMember.memberPoint : 0;\r\n  const [movieNo, setMovieNo] = useState(null);\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n  const [loginin, setLoginIn] = useState(false);\r\n\r\n  // 로그인 상태를 확인하여 loginin 설정\r\n  useEffect(() => {\r\n    const savedMember = sessionStorage.getItem(\"loginMember\");\r\n    if (savedMember) {\r\n      setLoginMember(JSON.parse(savedMember));\r\n      setLoginIn(true);\r\n    } else {\r\n      setLoginIn(false);\r\n    }\r\n  }, [setLoginMember]);\r\n\r\n  const openModal = () => {\r\n    setTempSelectedSeats([...selectedSeat]);\r\n    setIsModalOpen(true);\r\n  };\r\n  \r\n  const closeModal = () => {\r\n    setIsModalOpen(false);\r\n  };\r\n  //movieTitle을 selectedMovie에서 가져오기\r\n  const movieTitle = selectedMovie ? selectedMovie.movieTitle : \"영화 제목 없음\";\r\n // 현재 시간 불러옴\r\n  const MTDate = new Date();\r\n  const MTHours = MTDate.getHours();\r\n  const MTMinutes = MTDate.getMinutes();\r\n\r\n  const isTimePassed = (hour, minute) => {\r\n    if (!selectedDate) return false;\r\n    if (\r\n      selectedDate.getFullYear() === MTDate.getFullYear() &&\r\n      selectedDate.getMonth() === MTDate.getMonth() &&\r\n      selectedDate.getDate() === MTDate.getDate()\r\n    ) {\r\n      return hour < MTHours || (hour === MTHours && minute < MTMinutes);\r\n    }\r\n    return false;\r\n  };\r\n\r\n  const handleTimeChange = (time) => {\r\n    if (selectedDate) {\r\n      const [hour, minute, second] = time.split(\":\").map(Number);\r\n      if (isTimePassed(hour, minute)) {\r\n        alert(\"이미 지난 시간은 선택할 수 없습니다.\");\r\n        return;\r\n      }\r\n    }\r\n    setSelectedTime((prevTime) => (prevTime === time ? null : time));\r\n  };\r\n\r\n  const handleSeatClick = (seat) => {\r\n    if (tempSelectedSeats.includes(seat)) {\r\n      setTempSelectedSeats(tempSelectedSeats.filter((s) => s !== seat));\r\n    } else if (tempSelectedSeats.length < adultTickets + childTickets) {\r\n      setTempSelectedSeats([...tempSelectedSeats, seat]);\r\n    }\r\n  };\r\n\r\n  const confirmSeatSelection = () => {\r\n    setSelectedSeat(tempSelectedSeats);\r\n    closeModal();\r\n  };\r\n\r\n  const resetbutton = () => { //리셋버튼\r\n    setSelectedMovie(null);\r\n    setSelectedRegion(null);\r\n    setSelectedSeat([]);\r\n    setSelectedTime(null);\r\n    setSelectedDate(new Date());\r\n    setNumPeople(1);\r\n    setAdultTickets(0);\r\n    setChildTickets(0);\r\n    setUsePoints(0);\r\n  };\r\n\r\n  const handleMovieClick = (movie) => {\r\n    setSelectedMovie(movie);\r\n    setMovieNo(movie.movieNo);\r\n    setSelectedTime(null);// 영화 변경 시 시간 초기화\r\n  };\r\n\r\n  const getPosterPath = (movie) => {\r\n    return `${process.env.PUBLIC_URL}${movie.movieImage.replace(\"./\", \"/\")}`;\r\n  };\r\n\r\n  const PointUseTotalPrice = () => {\r\n    const totalPrice = adultTickets * 100 + childTickets * 100;\r\n    const finalPrice = usingPoints ? totalPrice - usePoints : totalPrice;\r\n    return finalPrice > 0 ? finalPrice : 0;\r\n  };\r\n\r\n  const UsePoints = () => {\r\n    setUsingPoints(!usingPoints);\r\n    if (!usingPoints) {\r\n      setUsePoints(0);\r\n    }\r\n  };\r\n\r\n  const UsePointChange = (e) => {\r\n    const value = parseInt(e.target.value);\r\n    const totalPrice = adultTickets * 100 + childTickets * 100;\r\n\r\n    if (!isNaN(value)) {\r\n      if (value > totalPrice) { // 총 결제 금액을 초과할 수 없도록 설정\r\n        setUsePoints(totalPrice);\r\n      } else if (value >= 0 && value <= Pointsheld) {\r\n        setUsePoints(value); // 입력된 포인트가 총 결제 금액 이하일 경우 설정\r\n      }\r\n    }\r\n  };\r\n\r\n  const Accumulate = () => { // 마일리지 포인트 적립\r\n    if (usingPoints) {\r\n      return 0; // 포인트를 사용할 경우 적립금은 0\r\n    }\r\n    return Math.floor((adultTickets * 100 + childTickets * 100) * 0.1);\r\n  };\r\n\r\n  const handleRegionChange = (region) => {\r\n    setSelectedRegion(prevRegion => prevRegion === region ? null : region);\r\n  };\r\n\r\n  const today = new Date();\r\n  const maxDate = new Date(today);\r\n  maxDate.setDate(today.getDate() + 6);\r\n\r\n  const handleDateChange = (date) => {\r\n    if (date >= today && date <= maxDate) {\r\n      setSelectedDate(date);\r\n      setSelectedTime(null); // 날짜 변경 시 선택한 시간 초기화\r\n    } else {\r\n      console.error(\"잘못된 날짜 선택\");\r\n    }\r\n  };\r\n\r\n  const calendar = ({ date, view }) => {\r\n    const maxDate = new Date(today);\r\n    maxDate.setDate(today.getDate() + 6);\r\n\r\n    const lastDayOfMonth = new Date(\r\n      today.getFullYear(),\r\n      today.getMonth() + 1,\r\n      0\r\n    );\r\n\r\n    return (\r\n      view === \"month\" &&\r\n      (date < today.setHours(0, 0, 0, 0) ||\r\n        date > maxDate ||\r\n        date > lastDayOfMonth)\r\n    );\r\n  };\r\n\r\n  const handleAdultTickets = (e) => {\r\n    const value = parseInt(e.target.value);\r\n    if (\r\n      !isNaN(value) &&\r\n      value >= 0 &&\r\n      value <= 4 &&\r\n      value + childTickets <= 4\r\n    ) {\r\n      setAdultTickets(value);\r\n      setSelectedSeat([]);\r\n    }\r\n  };\r\n\r\n  const handleChildTickets = (e) => {\r\n    const value = parseInt(e.target.value);\r\n    if (\r\n      !isNaN(value) &&\r\n      value >= 0 &&\r\n      value <= 4 &&\r\n      value + adultTickets <= 4\r\n    ) {\r\n      setChildTickets(value);\r\n      setSelectedSeat([]);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const fetchMovies = async () => {\r\n      try {\r\n        const response = await axios.get(\r\n          \"/moviepay/movies\"\r\n        );\r\n        setMovies(response.data);\r\n        if (movieId) {\r\n          const movie = response.data.find(\r\n            (m) => m.movieNo === parseInt(movieId)\r\n          );\r\n          setSelectedMovie(movie);\r\n        }\r\n      } catch (err) {\r\n        console.error(\"Error loading movie data: \", err);\r\n      }\r\n    };\r\n    fetchMovies();\r\n  }, [movieId]);\r\n\r\n  useEffect(() => {\r\n    const fetchAndSetSeats = async () => {\r\n      if (movieNo && selectedTime && selectedDate) {\r\n        const formattedDate = selectedDate\r\n          .toLocaleDateString(\"ko-KR\", {\r\n            year: \"numeric\",\r\n            month: \"2-digit\",\r\n            day: \"2-digit\",\r\n          })\r\n          .replace(/. /g, \"-\")\r\n          .replace(\".\", \"\");\r\n\r\n        try {\r\n          const fetchURL = `/moviepay/movieSeat/${movieNo}?viewDate=${formattedDate}&time=${selectedTime}`;\r\n          const response = await fetch(fetchURL);\r\n          if (!response.ok) {\r\n            throw new Error(`HTTP error! status: ${response.status}`);\r\n          }\r\n\r\n          const data = await response.json();\r\n           //좌석 데이터를 배열로 변환 (이 코드로 좌석 예매된거 표시 해결)\r\n          const parseData = data[0]\r\n            ? data[0].split(\",\").map((seat) => seat.trim())\r\n            : [];\r\n\r\n          setSelectedandSeat(parseData); // 이미 예약된 좌석을 비활성 상태로 설정\r\n        } catch (error) {\r\n          console.error(\"좌석 에러 :\", error);\r\n        }\r\n      } else {\r\n        console.error(\"값이 누락되었습니다\");\r\n      }\r\n    };\r\n\r\n    fetchAndSetSeats();\r\n  }, [movieNo, selectedTime, selectedDate]); //좌석 선택이 변경될 때마다 다시 불러옴\r\n\r\n  const handleConfirmPayment = () => {\r\n    // 로그인 상태를 loginin 대신 loginMember로 확인\r\n    if (!loginMember || !loginMember.memberNo) {\r\n      alert(\"로그인이 필요합니다. 로그인 페이지로 이동합니다.\");\r\n      navigate(\"/MemberLogin\");\r\n      return;\r\n    }\r\n\r\n    if (\r\n      !selectedMovie ||\r\n      !selectedRegion ||\r\n      !selectedDate ||\r\n      !selectedTime ||\r\n      (adultTickets === 0 && childTickets === 0) ||\r\n      selectedSeat.length === 0\r\n    ) {\r\n      alert(\"모든 항목을 선택해야 결제 페이지로 넘어갑니다.\");\r\n      return;\r\n    }\r\n\r\n    const selectedDateString = new Date(\r\n      selectedDate.getTime() - selectedDate.getTimezoneOffset() * 60000\r\n    )\r\n      .toISOString()\r\n      .split(\"T\")[0];\r\n\r\n      // 총 결제 금액 계산\r\n    const finalPrice = adultTickets * 100 + childTickets * 100 - usePoints;\r\n    const accumulatedPoints = usingPoints\r\n      ? 0\r\n      : Math.floor((adultTickets * 100 + childTickets * 100) * 0.1);\r\n      // Math.floor 소수점 버림처리\r\n\r\n      // 현재 포인트에 적립 포인트 더하기\r\n    const newTotalPoints =\r\n      Number(loginMember.memberPoint) - usePoints + Number(accumulatedPoints);\r\n\r\n      // 포인트 업데이트 반영한 회원 정보\r\n    const updatedLoginmember = {\r\n      ...loginMember,\r\n      memberPoint: newTotalPoints,\r\n    };\r\n\r\n    // 상태 업데이트\r\n    setLoginMember(updatedLoginmember);\r\n    setUserPoints(newTotalPoints);\r\n\r\n    // 로컬 스토리지에도 업데이트된 포인트 반영.\r\n    localStorage.setItem(\"loginMember\", JSON.stringify(updatedLoginmember));\r\n\r\n    alert(`결제 페이지로 넘어갑니다.`);\r\n    resetbutton();\r\n\r\n    navigate(\"/payment/checkout\", {\r\n      state: {\r\n        productName: `${\r\n          selectedMovie.movieTitle\r\n        } / ${movieNo} / ${selectedRegion} / ${selectedDate} / ${selectedTime} / ${selectedSeat.join(\r\n          \", \"\r\n        )}`,\r\n        movieTitle,\r\n        finalPrice,\r\n        adultTickets,\r\n        childTickets,\r\n        selectedSeat: selectedSeat.join(\", \"),  // 좌석을 문자열로 전달\r\n        selectedDate: selectedDateString,// 대한민국 시간대에 맞춘 YYYY-MM-DD 형식의 날짜 전달\r\n        selectedTime,\r\n        selectedRegion,\r\n        usePoints,\r\n        accumulatedPoints, // 새로 적립된 포인트 전달\r\n        memberNo: loginMember.memberNo,\r\n        movieNo: movieNo,\r\n        memberGrade: loginMember.memberGrade,\r\n        memberPayCount: loginMember.memberPayCount,\r\n        Pointsheld: newTotalPoints, // 업데이트된 포인트 전달\r\n      },\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"booking\">\r\n      <div className=\"movie-list\">\r\n        {movies.map((movie) => (\r\n          <div\r\n            key={movie.id}\r\n            className=\"movie-item\"\r\n            onClick={() => handleMovieClick(movie)}\r\n          >\r\n            <img src={getPosterPath(movie)} alt={movie.movieTitle} />\r\n            <p>{movie.title}</p>\r\n          </div>\r\n        ))}\r\n      </div>\r\n      <div className=\"content\">\r\n        <div className=\"resetbutton\">\r\n          <button onClick={resetbutton}>예매 다시하기</button>\r\n        </div>\r\n        <div className=\"MTheader\">\r\n          {selectedMovie ? (\r\n            <>\r\n              <div className=\"movie-info\">\r\n                <img src={getPosterPath(selectedMovie)} alt=\"Movie Poster\" />\r\n                <div className=\"movie-details\">\r\n                  <p>영화 : {selectedMovie.movieTitle}</p>\r\n                  <p>영화관 : {selectedRegion}</p>\r\n                  <p>\r\n                    관람일시 :{\" \"}\r\n                    {selectedDate\r\n                      ? selectedDate.toLocaleDateString(\"ko-KR\", {\r\n                          year: \"numeric\",\r\n                          month: \"long\",\r\n                          day: \"numeric\",\r\n                          weekday: \"long\",\r\n                        })\r\n                      : \"날짜를 선택하세요\"}\r\n                  </p>\r\n                  <p>상영시간 : {selectedTime}</p>\r\n                  <p>\r\n                    선택좌석 :{\" \"}\r\n                    {selectedSeat.length > 0 ? selectedSeat.join(\", \") : \"없음\"}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n              <div className=\"total-price\">\r\n                <div className=\"infobutton\">\r\n                  <p>총 결제금액: {PointUseTotalPrice()} 원</p>\r\n                  <p>\r\n                    포인트 사용 여부 :\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={usingPoints}\r\n                      onChange={UsePoints}\r\n                    />\r\n                    <p>보유 포인트 : {Pointsheld} 점 </p>\r\n                  </p>\r\n                  {usingPoints && (\r\n                    <p>\r\n                      사용할 포인트 :\r\n                      <input\r\n                        type=\"number\"\r\n                        value={usePoints}\r\n                        onChange={UsePointChange}\r\n                      />\r\n                    </p>\r\n                  )}\r\n                  <p>적립될 포인트 : {Accumulate()}점</p>\r\n                  <button\r\n                    className=\"confirm-button\"\r\n                    onClick={handleConfirmPayment}\r\n                  >\r\n                    결제\r\n                  </button>\r\n                </div>\r\n              </div>\r\n              <div>\r\n                <p>\r\n                  <strong>\r\n                    ※ 포인트를 사용해 예매 할 경우\r\n                    <br />\r\n                    포인트는 따로 적립되지 않습니다.\r\n                  </strong>\r\n                </p>\r\n                <p>\r\n                  <strong>※ 관람일 선택은 오늘 날짜 포함 7일 입니다.</strong>\r\n                </p>\r\n              </div>\r\n            </>\r\n          ) : (\r\n            <div className=\"default-movie-info\">\r\n              <img\r\n                src={process.env.PUBLIC_URL + \"/movieimages/select_movie1.jpg\"}\r\n                alt=\"Default\"\r\n              />\r\n              <p>선택한 영화가 없습니다.</p>\r\n            </div>\r\n          )}\r\n        </div>\r\n        <div className=\"steps-row\">\r\n          <div className=\"step\">\r\n            <p>STEP1: 영화관 선택</p>\r\n            <button\r\n              className={`step-button ${\r\n                selectedRegion === \"강남\" ? \"selected\" : \"fail\"\r\n              }`}\r\n              onClick={() => handleRegionChange(\"강남\")}\r\n            >\r\n              강남\r\n            </button>\r\n            <button\r\n              className={`step-button ${\r\n                selectedRegion === \"역삼\" ? \"selected\" : \"fail\"\r\n              }`}\r\n              onClick={() => handleRegionChange(\"역삼\")}\r\n            >\r\n              역삼\r\n            </button>\r\n          </div>\r\n          <div className=\"step\">\r\n            <p>STEP2: 관람일 선택</p>\r\n            <Calendar\r\n              className=\"mtcalendar\"\r\n              onChange={handleDateChange}\r\n              value={selectedDate || new Date()}\r\n              locale=\"ko-KR\"\r\n              minDate={today}\r\n              maxDate={maxDate}\r\n              tileDisabled={calendar}\r\n              showNeighboringMonth={false}\r\n            />\r\n          </div>\r\n          <div className=\"step\">\r\n            <p>STEP3: 관람시간 선택</p>\r\n            <button\r\n              className={`step-button ${selectedTime === '10:40:00' ? 'selected' : 'fail'}`}\r\n              onClick={() => handleTimeChange(\"10:40:00\")}\r\n            >\r\n              10:40\r\n            </button>\r\n            <button\r\n              className={`step-button ${selectedTime === '13:45:00' ? 'selected' : 'fail'}`}\r\n              onClick={() => handleTimeChange(\"13:45:00\")}\r\n            >\r\n              13:45\r\n            </button>\r\n            <button\r\n              className={`step-button ${selectedTime === '17:00:00' ? 'selected' : 'fail'}`}\r\n              onClick={() => handleTimeChange(\"17:00:00\")}\r\n            >\r\n              17:00\r\n            </button>\r\n            <button\r\n              className={`step-button ${selectedTime === '19:40:00' ? 'selected' : 'fail'}`}\r\n              onClick={() => handleTimeChange(\"19:40:00\")}\r\n            >\r\n              19:40\r\n            </button>\r\n            <button\r\n              className={`step-button ${selectedTime === '22:20:00' ? 'selected' : 'fail'}`}\r\n              onClick={() => handleTimeChange(\"22:20:00\")}\r\n            >\r\n              22:20\r\n            </button>\r\n          </div>\r\n          <div className=\"step\">\r\n            <p>STEP4: 좌석 및 잔여석 확인</p>\r\n            <div className=\"seat-selection\">\r\n              <label>\r\n                일반 (100원)\r\n                <input\r\n                  type=\"number\"\r\n                  min=\"0\"\r\n                  max=\"4\"\r\n                  value={adultTickets}\r\n                  onChange={handleAdultTickets}\r\n                />\r\n                <br />\r\n              </label>\r\n              <label>\r\n                청소년 (100원)\r\n                <input\r\n                  type=\"number\"\r\n                  min=\"0\"\r\n                  max=\"4\"\r\n                  value={childTickets}\r\n                  onChange={handleChildTickets}\r\n                />\r\n              </label>\r\n              <button className=\"step-button\" onClick={openModal}>\r\n                좌석 선택하기\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        {isModalOpen && (\r\n          <div className=\"modal-overlay\">\r\n            <div className=\"modal-content\">\r\n              <button className=\"close-button\" onClick={closeModal}>\r\n                &times;\r\n              </button>\r\n              <div className=\"screen\">\r\n                <p className=\"moviescreen\">SCREEN</p>\r\n                <div className=\"seats\">\r\n                  {[\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\"].map((row) => (\r\n                    <div key={row} className=\"seat-row\">\r\n                      <span className=\"row-label\">{row}</span>\r\n                      {[1, 2, 3, 4, 5, 6, 7, 8, 9].map((col) => {\r\n                        const seat = `${row}${col}`;\r\n                        return (\r\n                          <button\r\n                            key={seat}\r\n                            className={`seat ${\r\n                              tempSelectedSeats.includes(seat) ? \"selected\" : \"\"\r\n                            } ${\r\n                              selectedandSeat.includes(seat) ? \"booked\" : \"\"\r\n                            }`}\r\n                            onClick={() => handleSeatClick(seat)}\r\n                            disabled={selectedandSeat.includes(seat)}// 예매된 좌석은 비활성화\r\n                          >\r\n                            {seat}\r\n                          </button>\r\n                        );\r\n                      })}\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n              <button className=\"confirm-button\" onClick={confirmSeatSelection}>\r\n                선택 완료\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"notice\">\r\n          <p>예매 시 주의사항</p>\r\n          <dl>\r\n            <dt>1. 홈페이지 예매 후 영화별 실수관번호 발행될 수 있습니다.</dt>\r\n            <dt>\r\n              2. 영화 예매는 관람일 전날 취소 시 수수료 없이 취소 가능합니다.\r\n            </dt>\r\n            <dt>3. 상영관 입장은 상영시간 10분 전부터 가능합니다.</dt>\r\n            <dt>4. 할인혜택은 중복적용이 불가합니다.</dt>\r\n            <dt>5. 좌석은 한 계정당 총 4자리만 예매 가능합니다.</dt>\r\n          </dl>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Booking;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}