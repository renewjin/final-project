{"ast":null,"code":"import{loadTossPayments}from\"@tosspayments/tosspayments-sdk\";import{useEffect,useState}from\"react\";import{useNavigate,useLocation}from\"react-router-dom\";import'../../css/PaymentCheckoutPage.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const clientKey=\"test_ck_26DlbXAaV01XDv0Gew4xrqY50Q9R\";const generateRandomString=()=>window.btoa(Math.random().toString()).slice(0,20);const customerKey=generateRandomString();function PaymentCheckoutPage(){const[payment,setPayment]=useState(null);const[selectedPaymentMethod,setSelectedPaymentMethod]=useState(null);const navigate=useNavigate();const location=useLocation();const{productName,finalPrice,adultTickets,childTickets,selectedSeat,selectedDate,selectedTime,selectedRegion,movieID,memberNo,usePoints,accumulatedPoints,movieNo,movieTitle}=location.state||{};const selectPaymentMethod=method=>{setSelectedPaymentMethod(method);};useEffect(()=>{async function fetchPayment(){try{const tossPayments=await loadTossPayments(clientKey);const payment=tossPayments.payment({customerKey});setPayment(payment);}catch(error){console.error(\"결제 정보를 불러오는 중 오류가 발생했습니다:\",error);}}fetchPayment();},[]);useEffect(()=>{console.log(location.state);localStorage.setItem(\"payInfo\",JSON.stringify(location.state));},[location.state]);const requestPayment=async()=>{if(finalPrice===0){// 결제 금액 0이면 바로 결제 성공페이지로 이동\nnavigate(\"/payment/success\",{state:{amount:finalPrice,movieName:productName,seat:Array.isArray(selectedSeat)?selectedSeat.join(\", \"):\"\",// selectedSeat이 배열이면 join, 아니면 빈 문자열\nregion:selectedRegion,selectedDate,selectedTime}});return;}try{const orderId=generateRandomString();const response=await payment.requestPayment({method:selectedPaymentMethod,amount:{currency:\"KRW\",value:finalPrice},orderId,orderName:productName,successUrl:window.location.origin+\"/payment/success\",failUrl:window.location.origin+\"/payment/fail\",customerEmail:\"customer123@gmail.com\",customerName:\"김토스\",customerMobilePhone:\"01012341234\"});}catch(error){console.error(\"결제 요청 중 오류가 발생했습니다:\",error);}};return/*#__PURE__*/_jsx(\"div\",{className:\"wrapper\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"box_section\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\uC77C\\uBC18 \\uACB0\\uC81C\"}),/*#__PURE__*/_jsx(\"div\",{id:\"payment-method\",children:[\"CARD\",\"TRANSFER\",\"VIRTUAL_ACCOUNT\",\"MOBILE_PHONE\",\"CULTURE_GIFT_CERTIFICATE\",\"FOREIGN_EASY_PAY\"].map(method=>/*#__PURE__*/_jsx(\"button\",{id:method,className:`button2 ${selectedPaymentMethod===method?\"active\":\"\"}`,onClick:()=>selectPaymentMethod(method),children:method},method))}),/*#__PURE__*/_jsx(\"button\",{className:\"button\",onClick:requestPayment,children:\"\\uACB0\\uC81C\\uD558\\uAE30\"})]})});}export default PaymentCheckoutPage;","map":{"version":3,"names":["loadTossPayments","useEffect","useState","useNavigate","useLocation","jsx","_jsx","jsxs","_jsxs","clientKey","generateRandomString","window","btoa","Math","random","toString","slice","customerKey","PaymentCheckoutPage","payment","setPayment","selectedPaymentMethod","setSelectedPaymentMethod","navigate","location","productName","finalPrice","adultTickets","childTickets","selectedSeat","selectedDate","selectedTime","selectedRegion","movieID","memberNo","usePoints","accumulatedPoints","movieNo","movieTitle","state","selectPaymentMethod","method","fetchPayment","tossPayments","error","console","log","localStorage","setItem","JSON","stringify","requestPayment","amount","movieName","seat","Array","isArray","join","region","orderId","response","currency","value","orderName","successUrl","origin","failUrl","customerEmail","customerName","customerMobilePhone","className","children","id","map","onClick"],"sources":["C:/Users/user1/Desktop/sixsence/Sixsence/src/main/sixsence-front/src/moviechart/toss/PaymentCheckoutPage.js"],"sourcesContent":["import { loadTossPayments } from \"@tosspayments/tosspayments-sdk\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useNavigate, useLocation } from \"react-router-dom\";\r\nimport '../../css/PaymentCheckoutPage.css';\r\n\r\nconst clientKey = \"test_ck_26DlbXAaV01XDv0Gew4xrqY50Q9R\";\r\nconst generateRandomString = () => window.btoa(Math.random().toString()).slice(0, 20);\r\nconst customerKey = generateRandomString();\r\n\r\nfunction PaymentCheckoutPage() {\r\n  const [payment, setPayment] = useState(null);\r\n  const [selectedPaymentMethod, setSelectedPaymentMethod] = useState(null);\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const { productName, finalPrice, adultTickets, childTickets, selectedSeat, selectedDate, selectedTime, selectedRegion, movieID, memberNo, usePoints, accumulatedPoints, movieNo, movieTitle  } = location.state || {};\r\n\r\n  const selectPaymentMethod = (method) => {\r\n    setSelectedPaymentMethod(method);\r\n  };\r\n\r\n\r\n  useEffect(() => {\r\n    async function fetchPayment() {\r\n      try {\r\n        const tossPayments = await loadTossPayments(clientKey);\r\n        const payment = tossPayments.payment({\r\n          customerKey,\r\n        });\r\n        setPayment(payment);\r\n      } catch (error) {\r\n        console.error(\"결제 정보를 불러오는 중 오류가 발생했습니다:\", error);\r\n      }\r\n    }\r\n\r\n    fetchPayment();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    console.log(location.state);\r\n    localStorage.setItem(\"payInfo\", JSON.stringify(location.state));\r\n    \r\n  },[location.state]);\r\n\r\n  const requestPayment = async () => {\r\n    if (finalPrice === 0){\r\n      // 결제 금액 0이면 바로 결제 성공페이지로 이동\r\n      navigate(\"/payment/success\",{\r\n        state: {\r\n          amount: finalPrice,\r\n          movieName: productName,\r\n          seat: Array.isArray(selectedSeat) ? selectedSeat.join(\", \") : \"\", // selectedSeat이 배열이면 join, 아니면 빈 문자열\r\n          region: selectedRegion,\r\n          selectedDate,\r\n          selectedTime,\r\n        }\r\n      });\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      const orderId = generateRandomString();\r\n      const response = await payment.requestPayment({\r\n        method: selectedPaymentMethod,\r\n        amount: {\r\n          currency: \"KRW\",\r\n          value: finalPrice,\r\n        },\r\n        orderId,\r\n        orderName: productName,\r\n        successUrl: window.location.origin + \"/payment/success\",\r\n        failUrl: window.location.origin + \"/payment/fail\",\r\n        customerEmail: \"customer123@gmail.com\",\r\n        customerName: \"김토스\",\r\n        customerMobilePhone: \"01012341234\",\r\n      });\r\n   \r\n   \r\n    } catch (error) {\r\n      console.error(\"결제 요청 중 오류가 발생했습니다:\", error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"wrapper\">\r\n      <div className=\"box_section\">\r\n        <h1>일반 결제</h1>\r\n        <div id=\"payment-method\">\r\n          {[\"CARD\", \"TRANSFER\", \"VIRTUAL_ACCOUNT\", \"MOBILE_PHONE\", \"CULTURE_GIFT_CERTIFICATE\", \"FOREIGN_EASY_PAY\"].map((method) => (\r\n            <button\r\n              key={method}\r\n              id={method}\r\n              className={`button2 ${selectedPaymentMethod === method ? \"active\" : \"\"}`}\r\n              onClick={() => selectPaymentMethod(method)}\r\n            >\r\n              {method}\r\n            </button>\r\n          ))}\r\n        </div>\r\n        <button className=\"button\" onClick={requestPayment}>\r\n          결제하기\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default PaymentCheckoutPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}